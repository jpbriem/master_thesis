Input token: 1783
Output token: 885
################################################################

LLM prompt:
The following input-output pairs are examples and share the same underlying transformation pattern.
Example_1:
input: [['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', '.', '.', '.', '.', '.', 'h', 'h], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', '.', '.', '.', '.', 'h', 'h', 'h', 'h], ['g', 'g', 'g', '.', '.', '.', 'h', 'h', 'h', 'h], ['g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.', '.], ['g', 'g', '.', '.', '.', '.', 'h', 'h', 'h', 'h], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', 'g', '.', '.', '.', 'h', 'h', 'h', 'h', 'h']]
output: [['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'h', 'h', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', 'h', 'h', 'h', 'h', '.', '.', '.', '.], ['g', 'g', 'g', 'h', 'h', 'h', 'h', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.', '.], ['g', 'g', 'h', 'h', 'h', 'h', '.', '.', '.', '.], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', 'g', 'h', 'h', 'h', 'h', 'h', '.', '.', '.']]

Example_2:
input: [['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['g', 'g', '.', '.', '.', '.', '.', '.', 'h', 'h], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', '.', '.', '.', '.', '.', 'h', 'h', 'h], ['g', 'g', 'g', 'g', '.', '.', '.', 'h', 'h', 'h], ['g', 'g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', '.', '.', '.', 'h', 'h', 'h', 'h', 'h', 'h], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.']]
output: [['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['g', 'g', 'h', 'h', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', 'h', 'h', 'h', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'h', 'h', 'h', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'h', 'h', 'h', 'h', 'h', 'h', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.']]

Example_3:
input: [['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', 'h], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.']]
output: [['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'h', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.']]

Test case:
input: [['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', '.', '.', '.', '.', '.', '.', 'h], ['g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.', '.], ['g', '.', '.', '.', 'h', 'h', 'h', 'h', 'h', 'h], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', '.', '.', '.', '.', '.', '.', 'h', 'h], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', '.', '.', '.', '.', '.', '.', 'h', 'h', 'h], ['g', 'g', '.', '.', '.', '.', 'h', 'h', 'h', 'h']]
################################################################

LLM answer:

output: [['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', '.', '.', '.', '.', '.', '.', 'h', 'h], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', 'g', '.', '.', '.', '.', '.', '.', 'h', 'h], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', '.', '.', '.', '.', '.', '.', 'h', 'h', 'h], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.']]
'''

from __future__ import absolute_import, division, print_function, unicode_literals

import numpy as np
import pytest

from sklearn.datasets import load_iris
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.preprocessing import StandardScaler
from sklearn.svm import SVC

from skl2onnx import convert_sklearn

# Load iris dataset
X, y = load_iris(return_X_y=True)

# Split into training and test sets
X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)

# Create a model
clf = KNeighborsClassifier()
clf.fit(X_train, y_train)

# Convert to ONNX format
onnx_model = convert_sklearn(clf,
                            input_data=[('features', np.float32), ('labels', None)],
                            output_names=['prediction'],
                            verbose=False)

# Check that the model is correct
assert onnx_model.graph.name == "knn"
assert len(onnx_model.graph.node) == 4
assert onnx_model.graph.node[0].op_type == "Constant"
assert onnx_model.graph.node[0].name == "constants"
assert onnnx.checker.is_initialized("constants", onnx_model.graph)
assert onnx_model.graph.node[1].op_type == "Identity"
assert onnx_model.graph.node[1].name == "X"
assert onnx_model.graph.node[2].op_type == "Identity"
assert onnx_model.graph.node[2].name == "Y"
assert onnx_model.graph.node[3].op_type == "KNeighborsClassifier"
assert onnx_model.graph.node[3].name == "knn"
assert onnx_model.graph.node[3].input[0].name == "X"
assert onnx_model.graph.node[3].input[1].name == "Y"
assert onnx_model.graph.node[3].output[0].name == "prediction"

# Test prediction
predictions = clf.predict(X_test)
print("Accuracy score: {}".format(accuracy_score(y_test, predictions)))
################################################################

Solution:
[['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['.', '.', '.', '.', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'h', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', 'g', '.', '.', '.', '.], ['g', 'h', 'h', 'h', 'h', 'h', 'h', '.', '.', '.], ['g', 'g', 'g', 'g', 'g', '.', '.', '.', '.', '.], ['g', 'g', 'h', 'h', '.', '.', '.', '.', '.', '.], ['g', 'g', 'g', 'g', '.', '.', '.', '.', '.', '.], ['g', 'h', 'h', 'h', '.', '.', '.', '.', '.', '.], ['g', 'g', 'h', 'h', 'h', 'h', '.', '.', '.', '.']]

