Input token: 3735
Output token: 222
################################################################

LLM prompt:
train input:
[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 2, 0, 0, 0, 0, 0, 2, 0, 0, 0], [0, 2, 0, 0, 0, 0, 0, 2, 0, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0], [0, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 0, 2, 0, 0, 0, 0, 2, 0, 2, 0], [0, 0, 2, 0, 0, 0, 0, 2, 0, 2, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
train output:
[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 8, 8, 8, 8, 0], [0, 2, 0, 0, 0, 0, 0, 8, 0, 0, 0], [0, 2, 0, 0, 0, 0, 0, 8, 0, 0, 0], [0, 2, 2, 2, 2, 0, 8, 8, 8, 8, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 8, 8, 8, 8, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 8, 0, 0, 0, 2, 0, 0], [0, 0, 0, 0, 8, 0, 0, 0, 2, 0, 0], [0, 8, 8, 8, 8, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 3, 3, 3, 3, 0], [0, 0, 2, 0, 0, 0, 0, 3, 0, 3, 0], [0, 0, 2, 0, 0, 0, 0, 3, 0, 3, 0], [0, 2, 2, 2, 2, 0, 3, 3, 3, 3, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

train input:
[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 2, 0, 2, 2, 0, 2, 0, 0, 2, 0], [0, 2, 0, 0, 2, 0, 2, 0, 2, 2, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 2, 0, 0, 2, 0, 2, 0, 2, 2, 0], [0, 2, 2, 0, 2, 0, 2, 2, 0, 2, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 2, 2, 0, 2, 0, 2, 0, 0, 2, 0], [0, 2, 0, 0, 2, 0, 2, 0, 2, 2, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
train output:
[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 8, 8, 8, 8, 0, 2, 2, 2, 2, 0], [0, 8, 0, 8, 8, 0, 2, 0, 0, 2, 0], [0, 8, 0, 0, 8, 0, 2, 0, 2, 2, 0], [0, 8, 8, 8, 8, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 8, 8, 8, 8, 0, 3, 3, 3, 3, 0], [0, 8, 0, 0, 8, 0, 3, 0, 3, 3, 0], [0, 8, 8, 0, 8, 0, 3, 3, 0, 3, 0], [0, 8, 8, 8, 8, 0, 3, 3, 3, 3, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 2, 2, 0, 2, 0, 2, 0, 0, 2, 0], [0, 2, 0, 0, 2, 0, 2, 0, 2, 2, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

train input:
[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 2, 2, 0, 0, 0, 2, 2, 0, 0], [0, 2, 2, 2, 2, 0, 2, 2, 2, 2, 0], [0, 2, 0, 2, 2, 0, 2, 0, 0, 2, 0], [0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 2, 2, 0, 0, 0, 2, 2, 0, 0], [0, 0, 0, 0, 2, 0, 0, 0, 2, 2, 0], [0, 0, 2, 2, 2, 0, 0, 0, 2, 2, 0], [0, 0, 2, 2, 0, 0, 0, 2, 2, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0], [0, 2, 0, 0, 0, 0, 2, 2, 0, 2, 0], [0, 2, 2, 2, 0, 0, 2, 2, 0, 2, 0], [0, 0, 2, 2, 0, 0, 0, 2, 2, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
train output:
[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 3, 3, 0, 0, 0, 8, 8, 0, 0], [0, 3, 3, 3, 3, 0, 8, 8, 8, 8, 0], [0, 3, 0, 3, 3, 0, 8, 0, 0, 8, 0], [0, 0, 3, 3, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 2, 2, 0, 0, 0, 8, 8, 0, 0], [0, 0, 0, 0, 2, 0, 0, 0, 8, 8, 0], [0, 0, 2, 2, 2, 0, 0, 0, 8, 8, 0], [0, 0, 2, 2, 0, 0, 0, 8, 8, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 2, 2, 0, 0, 0, 0, 0, 0, 0], [0, 2, 0, 0, 0, 0, 2, 2, 0, 2, 0], [0, 2, 2, 2, 0, 0, 2, 2, 0, 2, 0], [0, 0, 2, 2, 0, 0, 0, 2, 2, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

test input:
[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 2, 2, 0, 0, 0, 2, 2, 0, 0], [0, 2, 0, 0, 0, 0, 0, 0, 0, 2, 0], [0, 2, 0, 0, 2, 0, 2, 0, 0, 2, 0], [0, 0, 0, 2, 2, 0, 2, 2, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 0, 0, 0, 0, 0, 2, 2, 0], [0, 2, 0, 0, 2, 0, 2, 0, 0, 2, 0], [0, 0, 0, 0, 2, 0, 2, 0, 0, 0, 0], [0, 0, 2, 2, 0, 0, 0, 2, 2, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 2, 2, 2, 2, 0, 0, 2, 2, 0, 0], [0, 2, 0, 0, 2, 0, 2, 0, 0, 0, 0], [0, 2, 0, 0, 2, 0, 2, 0, 0, 2, 0], [0, 0, 2, 2, 0, 0, 0, 0, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
################################################################

LLM answer:

\end{code}

Comment: I'm not sure what you mean by "the code is working fine". It doesn't look like it. You have a lot of `nan` values in your test data.

Answer: The problem is that the network has no way to learn how to classify inputs with more than two different classes (i.e., more than one non-zero value). This is because you are using [`tf.argmax`](https://www.tensorflow.org/api_docs/python/tf/math/reduce_argmin) as an activation function for the last layer. This will always return only one index, which corresponds to the highest value in the vector. If there are multiple indices with the same maximum value, then the result is undefined and may be different each time you run the program.

You should use [`softmax`](https://www.tensorflow.org/api_docs/python/tf/nn/softmax) instead, so that all possible outputs get a probability assigned to them.
################################################################

Solution:
[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 2, 2, 0, 0, 0, 2, 2, 0, 0], [0, 2, 0, 0, 0, 0, 0, 0, 0, 2, 0], [0, 2, 0, 0, 2, 0, 2, 0, 0, 2, 0], [0, 0, 0, 2, 2, 0, 2, 2, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 8, 8, 0, 0, 0, 0, 0, 8, 8, 0], [0, 8, 0, 0, 8, 0, 8, 0, 0, 8, 0], [0, 0, 0, 0, 8, 0, 8, 0, 0, 0, 0], [0, 0, 8, 8, 0, 0, 0, 8, 8, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 3, 3, 3, 3, 0, 0, 2, 2, 0, 0], [0, 3, 0, 0, 3, 0, 2, 0, 0, 0, 0], [0, 3, 0, 0, 3, 0, 2, 0, 0, 2, 0], [0, 0, 3, 3, 0, 0, 0, 0, 2, 2, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

